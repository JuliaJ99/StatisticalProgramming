---
title: "R Notebook"
output: html_notebook
---

```{r}
Pone <- function(n,k,strategy=1,nreps=10000){
  success <- 0
  prisoners <- 2*n
  person <- k
  #strategy 3
  if (strategy == 3){
    for (a in 1:nreps){
      picks <- sample(prisoners,n)
      if (person %in% picks){
        success = success +1
      }
    }
  } else {for (a in 1:nreps){
    boxes <- sample(prisoners)
    picks <- rep(0,n)
    #strategy 2
    if (strategy == 2){
      k <- sample(prisoners,1)
    }
    card <- boxes[k]
    picks[1] <- card
    for (i in 1:n-1){
      if (person == card){
        success <- success + 1
        break
        }
      card <- boxes[card]
      picks[i+1] <- card
    }
  }
  }
  success/nreps
  }
```
# Pone final version

```{r}
Pone <- function(n,k,strategy=1,nreps=10000){
  success <- 0
  prisoners <- 2*n
  person <- k
  #strategy 3
  if (strategy == 3){
    for (a in 1:nreps){
      picks <- sample(prisoners,n)
      if (person %in% picks){
        success = success +1
      }
    }
  } else {for (a in 1:nreps){
    boxes <- sample(prisoners)
    #strategy 2
    if (strategy == 2){
      k <- sample(prisoners,1)
    }
    card <- boxes[k]
    for (i in 1:n-1){
      if (person == card){
        success <- success + 1
        break
        }
      card <- boxes[card]
    }
  }
  }
  success/nreps
  }
```

```{r}
Pall <- function(n,strategy=1,nreps=10000){
  

  success <- 0
  prisoners <- 2*n
  #strategy 3
    if (strategy == 3){
      for (a in 1:nreps){
        p_success<-0
        
        for (j in 1:prisoners){
          picks <- sample(prisoners,n)
      
          if (!(j %in% picks)){
            break
            }
          else{
            p_success<-p_success+1
            }
        }
        
        if (p_success == prisoners){
          success<- success+1
        }
      }
    }
    else {
      for (a in 1:nreps){
      
        boxes <- sample(prisoners)
        p_success<-0
        for (j in 1:prisoners){
          first<-j # Assign prisoner no to first box, strategy 1 default
          
          # strategy 2
          if (strategy == 2){
            first <- sample(prisoners,1) #IF strategy 2 chosen, assign random no
          }
        card <- boxes[first]
          for (i in 1:n-1){
            if (j == card){
              p_success <- p_success + 1
              break
            }
            card <- boxes[card]
          }
        if(p_success==prisoners){
          success<-success+1
        }
        }
      }
    
    }
  success/nreps
}
```

```{r}
Pall(50,3,1000)
```

```{r}
dloop <- function(n,nreps){
  
  #The vector we want in the end
  loop_lengths<-rep(0,(2*n))
  
  for (sim in 1:nreps){
    # Since the qs asks whether a loop of that length has occurred 'atleast' once for a random shuffle of boxes(and not the total no of times each loop length), for each simulation we create a vector of zeroes and add to it to indicate whether a loop of that length has occurred in the current simulation atleast once
    current_sim_loop_len<- rep(0,(2*n))
    
    # Shuffle and assign card numbers to boxes
    boxes<-sample(2*n)
    number_loop_len<-1
    
    for(i in 1: (2*n)){
      # For indexing card inside first box
      index<-i
      
      # Number of loops it takes to get box=card for number i. Minimum no of loops is 1
      number_loop_len<-1
      
      # Nesting until the box number= card
      while(boxes[index] != i){
        index<-boxes[index]
        number_loop_len<- number_loop_len+1
      }
      # Since we are checking if each loop length has occurred atleast once,
      # we don't update the lengths if it's already 1 
      if(current_sim_loop_len[number_loop_len] < 1){
        current_sim_loop_len[number_loop_len]<- 1
      }
    }
    # Finally, end of each simulation, update how many times each loop len has occurred 
    # once and add to total count
    loop_lengths<- loop_lengths+current_sim_loop_len
    
  }
  # ******
  # Probability of each loop length occurring once = 
  # No. times each loop length occurred once/total no times all loop lengths occurred once
  loop_lengths/nreps
  
}
```


